Given a thermal specification $\system$ (see \sref{architecture-model}), an equivalent thermal RC circuit with $\nodes$ thermal nodes is constructed \cite{kreith2000}. The structure of the circuit depends on the intended level of granularity and, therefore, defines the resulting accuracy. For clarity of presentation, we assume that each processing element is mapped onto one corresponding node, and the thermal package is represented as a set of additional nodes. An example of such a circuit for a dual-core architecture is depicted in \fref{circuit} in the appendix. The appendix, \aref{thermal-model}, also contains a derivation of the equations below.

The thermal behavior of the circuit is modeled with the following system of differential-algebraic equations (DAEs):
\begin{subnumcases}{\elabel{fourier-system}}
  \frac{d\vX(\t, \o)}{d\t} = \mA \: \vX(\t, \o) + \mB \: \vP(\t, \o) \elabel{fourier-de} \\
  \vTO(\t, \o) = \mB^T \vX(\t, \o) + \vTO_\amb \elabel{fourier-output}
\end{subnumcases}
where $\vP, \vTO \in \real^\cores$ are the input power and output temperature vectors of the processing elements, respectively, and $\vX \in \real^{\nodes}$ is the vector of the internal state of the system. In general, \eref{fourier-de} does not have a closed-form solution due to the power term, which is an arbitrary function.

Recall that the power profile we work with is a discrete-time representation of the power consumption, which contains $\steps$ power samples, or steps (see \sref{problem-formulation}). As detailed in \aref{thermal-model}, we let the total power be constant between neighbor steps of $\profPdyn$ and reduce the solution process of \eref{fourier-system} to the recurrence, for $k = 1, \dotsc, \steps$,
\begin{equation} \elabel{recurrence}
  \vX_k(\o) = \mCF_k \: \vX_{k - 1}(\o) + \mCS_k \: \vP_k(\o) \hspace{1em} \text{where} \hspace{1em} \vX_0(\o) = \vZero.
\end{equation}
In the deterministic case, \eref{recurrence} can be readily employed to perform the deterministic transient PTA \cite{thiele2011, ukhov2012}. In the stochastic case, however, the analysis of \eref{recurrence} is substantially different since $\vP_k(\o)$ and, consequently, $\vX_k(\o)$ and $\vTO_k(\o)$ are probabilistic quantities. The situation is complicated by the fact that, at each step of the iterative process, (a) $\vP_k(\o)$ is an arbitrary transformation of the uncertain parameters $\vU(\o)$ and stochastic temperature $\vTO_k(\o)$ (see \sref{power-model}), which results in a multivariate \rv\ with a generally unknown probability distribution; (b) $\vU(\o)$, $\vP_k(\o)$, $\vX_k(\o)$, and $\vTO_k(\o)$ are dependent \rvs\ as the latter three are functions of $\vU(\o)$. Therefore, the operations involved in \eref{recurrence} are to be performed on dependent \rvs\ with arbitrary probability distributions, which, in general, have no closed-form solutions. To tackle this difficulty, we utilize spectral expansions mentioned earlier and further discussed in the next section.
